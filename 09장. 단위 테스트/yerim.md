# 9장 단위테스트

## **TDD 법칙 세 가지**

- **첫째 법칙:** 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
- **둘째 법칙:** 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
- **셋째 법칙:** 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.

위 세 가지 규칙을 따르면 개발과 테스트가 대략 30초 주기로 묶인다.

## **깨끗한 테스트 코드 유지하기**

- 테스트는 유연성, 유지보수성, 재사용성을 제공한다
- 테스트 코드가 지저분하면 코드를 변경하는 능력이 떨어지며 코드 구조를 개선하는 능력도 떨어진다.

## **깨끗한 테스트 코드**

- **가독성, 가독성, 가독성.**가독성은 실제 코드보다 테스트 코드에 더더욱 중요하다.
- 명료성, 단순성, 풍부한 표현력이 필요하다. 테스트 코드는 최소의 표현으로 많은 것을 나타내야 한다.
- **BUILD-OPERATE-CHECK 패턴**
    - 첫 째, 테스트 자료를 만든다.
    - 두 번째, 테스트 자료를 조작
    - 세 번째, 조작한 결과가 올바른지 확인한다.

## ****테스트 당 assert 하나****

given-when-then

- 테스트 코드를 읽기가 쉬워진다.
- **테스트를 분리하면 중복되는 코드가 많아진다.**
- **가장 좋은 규칙은 "개념 당 assert 문 수를 최소로 줄여라"와 "테스트 함수 하나는 개념 하나만 테스트하라"**

## ****F.I.R.S.T****

- **빠르게Fast :** 자주 돌리지 않으면 초반에 문제를 찾아내 고치지 못한다.
- **독립적으로Independent :** 하나가 실패할 때 나머지도 잇달아 실패하므로 원인을 진단하기 어려워진다.
- **반복가능하게Repeatable :** 테스트는 어떤 환경에서도 반복 가능해야 한다. 실제 환경, QA 환경, 버스를 타고 집으로 가는 길에 사용하는 노트북 환경(네트워크가 연결되지 않은)에서도 실행할 수 있어야 한다. 테스트가 돌아가지 않는 환경이 하나라도 있다면 테스트가 실패한 이유를 둘러댈 변명이 생긴다. 게다가 환경이 지원되지 않기에 테스트를 수행하지 못하는 상황에 직면한다.
- **자가검증하는Self-Validating :** 테스트는 bool값으로 결과를 내야 한다. 성공 아니면 실패다.  통과 여부를 보려고 텍스트 파일 두 개를 수작업으로 비교하게 만들어서도 안 된다.
- **적시에Timely :** 실제 코드를 구현하기 직전에 구현한다. 실제 코드를 구현한 다음에 테스트 코드를 만들면 실제 코드가 테스트하기 어렵다는 사실을 발견할지도 모른다.